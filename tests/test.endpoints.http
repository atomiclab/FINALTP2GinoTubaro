@Host=http://127.0.0.1
@Port=3000
@BaseUrl={{Host}}:{{Port}}

### ============================================
### INSTRUCCIONES PARA OBTENER TOKEN JWT
### ============================================
### 1. Primero necesitas crear un usuario (si no existe) usando el endpoint de autenticación
### 2. Luego hacer login para obtener el token JWT:
###    POST {{BaseUrl}}/api/auth/login
###    Body: { "mail": "tu@email.com", "contrasena": "tuPassword" }
### 3. Copiar el token de la respuesta y reemplazar {{token}} en las peticiones protegidas
### ============================================

### Variables para pruebas
### Reemplazar estos valores con datos reales después de crear un usuario y hacer login
@token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2OTJlMTFmNGEyMzVmNDM2ZWU3Yjk2MDkiLCJtYWlsIjoiZ2lub0B0ZXN0LmNvbSIsImlhdCI6MTc2NDYyOTk3NywiZXhwIjoxNzY0NzE2Mzc3fQ.hoyWQ1LuaTY8sDtjUQ15qexEbEspb1JMyVwwq3v9FIk
@productoId=692e1d409b09f2c0f9c0c762

### ============================================
### AUTENTICACIÓN
### ============================================

### 1. Crear usuario (necesario para obtener token)
POST {{BaseUrl}}/api/usuarios
Content-Type: application/json

{
    "nombre": "Gino",
    "apellido": "Tubaro",
    "mail": "gino@test.com",
    "contrasena": "123456",
    "edad": 28
}

### 2. Login - Obtener token JWT
### Usar las credenciales del usuario creado en el paso anterior
POST {{BaseUrl}}/api/auth/login
Content-Type: application/json

{
    "mail": "gino@test.com",
    "contrasena": "123456"
}

### ============================================
### PRODUCTOS - CRUD
### ============================================

### 3. Crear un nuevo producto (NO requiere autenticación)
POST {{BaseUrl}}/api/v1/productos
Content-Type: application/json

{
    "producto": "Laptop Dell XPS 15",
    "stockAmount": 10
}

### 4. Crear producto con fechaIngreso personalizada
POST {{BaseUrl}}/api/v1/productos
Content-Type: application/json

{
    "producto": "Impresora 3D BambuLab A1",
    "stockAmount": 25,
    "fechaIngreso": "2025-01-15"
}

### 5. Listar todos los productos (NO requiere autenticación)
GET {{BaseUrl}}/api/v1/productos

### 6. Obtener un producto por ID (NO requiere autenticación)
### Reemplazar {{productoId}} con un ID válido después de crear un producto
GET {{BaseUrl}}/api/v1/productos/{{productoId}}

### 7. Intentar actualizar producto SIN autenticación (debe fallar con 401/403)
PUT {{BaseUrl}}/api/v1/productos/{{productoId}}
Content-Type: application/json

{
    "producto": "Laptop Dell XPS 15 Actualizada",
    "stockAmount": 15
}

### 8. Actualizar producto CON JWT Token válido (REQUIERE autenticación)
### Reemplazar {{token}} con el token obtenido del login
PUT {{BaseUrl}}/api/v1/productos/{{productoId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "producto": "Laptop Dell XPS 15 Actualizada",
    "stockAmount": 15
}

### 9. Actualizar solo el stock (incremento mínimo 1)
PUT {{BaseUrl}}/api/v1/productos/{{productoId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "stockAmount": 20
}

### 9b. Incrementar stock usando endpoint dedicado (REQUIERE autenticación)
PATCH {{BaseUrl}}/api/v1/productos/{{productoId}}/stock
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "incremento": 5
}

### 10. Intentar eliminar producto SIN autenticación (debe fallar con 401/403)
DELETE {{BaseUrl}}/api/v1/productos/{{productoId}}

### 11. Eliminar producto CON JWT Token válido (REQUIERE autenticación)
### Reemplazar {{token}} con el token obtenido del login
DELETE {{BaseUrl}}/api/v1/productos/{{productoId}}
Authorization: Bearer {{token}}

### ============================================
### VALIDACIONES Y ERRORES
### ============================================

### 12. Crear producto sin campo producto (debe fallar)
POST {{BaseUrl}}/api/v1/productos
Content-Type: application/json

{
    "stockAmount": 10
}

### 13. Crear producto con stockAmount negativo (debe fallar)
POST {{BaseUrl}}/api/v1/productos
Content-Type: application/json

{
    "producto": "Producto Test",
    "stockAmount": -5
}

### 14. Crear producto con stockAmount no entero (debe fallar)
POST {{BaseUrl}}/api/v1/productos
Content-Type: application/json

{
    "producto": "Producto Test",
    "stockAmount": 10.5
}

### 15. Actualizar con incremento de stock menor a 1 (debe fallar)
PUT {{BaseUrl}}/api/v1/productos/{{productoId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
    "stockAmount": 0
}

### 16. Obtener producto con ID inválido (debe retornar 404)
GET {{BaseUrl}}/api/v1/productos/507f1f77bcf86cd799439011

### ============================================
### ALBUMS CSV
### ============================================

### 17. Obtener albums en formato CSV (NO requiere autenticación)
### Este endpoint consume la API externa, toma los primeros 15 registros,
### los convierte a CSV, los guarda en database/albums_15.csv y devuelve el CSV
GET {{BaseUrl}}/api/v1/albums/csv
